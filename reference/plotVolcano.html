<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Make volcano plots — plotVolcano • einprot</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Make volcano plots — plotVolcano"><meta property="og:description" content="Construct interactive and non-interactive volcano plots, MA plots,
STRING networks of up- and downregulated proteins, bar plots of average
abundances and log-fold changes, as well as plots of top-ranked feature
collections."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">einprot</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/einprot.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Make volcano plots</h1>
    
    <div class="hidden name"><code>plotVolcano.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Construct interactive and non-interactive volcano plots, MA plots,
STRING networks of up- and downregulated proteins, bar plots of average
abundances and log-fold changes, as well as plots of top-ranked feature
collections.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotVolcano</span><span class="op">(</span></span>
<span>  <span class="va">sce</span>,</span>
<span>  <span class="va">res</span>,</span>
<span>  <span class="va">testType</span>,</span>
<span>  xv <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  yv <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xvma <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  volcind <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plotnote <span class="op">=</span> <span class="st">""</span>,</span>
<span>  plottitle <span class="op">=</span> <span class="st">""</span>,</span>
<span>  plotsubtitle <span class="op">=</span> <span class="st">""</span>,</span>
<span>  volcanoFeaturesToLabel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span>,</span>
<span>  volcanoMaxFeatures <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  volcanoLabelSign <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>  baseFileName <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">comparisonString</span>,</span>
<span>  groupComposition <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stringDb <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  featureCollections <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  complexFDRThr <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  maxNbrComplexesToPlot <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  curveparam <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  abundanceColPat <span class="op">=</span> <span class="st">""</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"log2(fold change)"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"-log10(p-value)"</span>,</span>
<span>  xlabma <span class="op">=</span> <span class="st">"Average abundance"</span>,</span>
<span>  labelOnlySignificant <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  interactiveDisplayColumns <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  interactiveGroupColumn <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  makeInteractiveVolcano <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  maxTextWidthBarplot <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt id="arg-sce">sce<a class="anchor" aria-label="anchor" href="#arg-sce"></a></dt>
<dd><p>A <code>SummarizedExperiment</code> object (or a derivative). Can be
<code>NULL</code> if no "complex bar plots" are made (i.e., if
<code>featureCollections</code> has no entry named "complexes", or if
<code>baseFileName</code> is <code>NULL</code>).</p></dd>


<dt id="arg-res">res<a class="anchor" aria-label="anchor" href="#arg-res"></a></dt>
<dd><p>A <code>data.frame</code> object with test results (typically
generated by <code>runTest</code>).</p></dd>


<dt id="arg-testtype">testType<a class="anchor" aria-label="anchor" href="#arg-testtype"></a></dt>
<dd><p>Character scalar indicating the type of test that was run,
either <code>"ttest"</code>, <code>"limma"</code> or <code>"proDA"</code>.</p></dd>


<dt id="arg-xv-yv">xv, yv<a class="anchor" aria-label="anchor" href="#arg-xv-yv"></a></dt>
<dd><p>Character scalars indicating which columns of <code>res</code> that
should be used as the x- and y-axis of the volcano plot, respectively.
If <code>NULL</code>, will be determined based on <code>testType</code>.</p></dd>


<dt id="arg-xvma">xvma<a class="anchor" aria-label="anchor" href="#arg-xvma"></a></dt>
<dd><p>If not <code>NULL</code>, a character scalar indicating which
column of <code>res</code> should be used as the x-axis for an MA plot. The
y-axis column will be <code>xv</code>. If <code>NULL</code>, no MA plot is
generated.</p></dd>


<dt id="arg-volcind">volcind<a class="anchor" aria-label="anchor" href="#arg-volcind"></a></dt>
<dd><p>Character scalar indicating which column in <code>res</code> that
represents the "significance" column. This should be a logical
column; rows with a value equal to <code>TRUE</code> will be colored
in the plot. If <code>NULL</code>, will be determined based on <code>testType</code>.</p></dd>


<dt id="arg-plotnote">plotnote<a class="anchor" aria-label="anchor" href="#arg-plotnote"></a></dt>
<dd><p>Character scalar with a note to add to the plot.</p></dd>


<dt id="arg-plottitle">plottitle<a class="anchor" aria-label="anchor" href="#arg-plottitle"></a></dt>
<dd><p>Character scalar giving the title of the plot.</p></dd>


<dt id="arg-plotsubtitle">plotsubtitle<a class="anchor" aria-label="anchor" href="#arg-plotsubtitle"></a></dt>
<dd><p>Character scalar giving the subtitle of the plot.</p></dd>


<dt id="arg-volcanofeaturestolabel">volcanoFeaturesToLabel<a class="anchor" aria-label="anchor" href="#arg-volcanofeaturestolabel"></a></dt>
<dd><p>Character vector, features to label in the
plot.</p></dd>


<dt id="arg-volcanomaxfeatures">volcanoMaxFeatures<a class="anchor" aria-label="anchor" href="#arg-volcanomaxfeatures"></a></dt>
<dd><p>Numeric scalar, the maximum number of features
to color in the plot.</p></dd>


<dt id="arg-volcanolabelsign">volcanoLabelSign<a class="anchor" aria-label="anchor" href="#arg-volcanolabelsign"></a></dt>
<dd><p>Character scalar, either <code>"both"</code>, <code>"pos"</code>,
or <code>"neg"</code>, indicating whether to label the most significant
features regardless of sign, or only those with positive/negative
log-fold changes.</p></dd>


<dt id="arg-basefilename">baseFileName<a class="anchor" aria-label="anchor" href="#arg-basefilename"></a></dt>
<dd><p>Character scalar or <code>NULL</code>, the base file name of
the output files. If <code>NULL</code>, no result files are generated.</p></dd>


<dt id="arg-comparisonstring">comparisonString<a class="anchor" aria-label="anchor" href="#arg-comparisonstring"></a></dt>
<dd><p>Character scalar giving the name of the comparison of
interest. This is used to extract the appropriate column from the
metadata of the feature collections to make the gene set plots.</p></dd>


<dt id="arg-groupcomposition">groupComposition<a class="anchor" aria-label="anchor" href="#arg-groupcomposition"></a></dt>
<dd><p>A list providing the composition of each group
used in the comparisons indicated by <code>comparisonString</code>.
If <code>NULL</code>, assumes that each group used in <code>comparisonString</code>
consists of a single group in the <code>group</code> column of
<code>colData(sce)</code>.</p></dd>


<dt id="arg-stringdb">stringDb<a class="anchor" aria-label="anchor" href="#arg-stringdb"></a></dt>
<dd><p>A STRINGdb object or <code>NULL</code>. If not <code>NULL</code>,
STRING network plots of up- and downregulated genes will be added to
the output pdf file.</p></dd>


<dt id="arg-featurecollections">featureCollections<a class="anchor" aria-label="anchor" href="#arg-featurecollections"></a></dt>
<dd><p>A list of <code>CharacterList</code>s with feature
collections. If there is a collection named <code>"complexes"</code>,
volcano plots and barplots for significant complexes are included in
the output pdf files.</p></dd>


<dt id="arg-complexfdrthr">complexFDRThr<a class="anchor" aria-label="anchor" href="#arg-complexfdrthr"></a></dt>
<dd><p>Numeric scalar giving the FDR threshold for complexes
to be considered significant.</p></dd>


<dt id="arg-maxnbrcomplexestoplot">maxNbrComplexesToPlot<a class="anchor" aria-label="anchor" href="#arg-maxnbrcomplexestoplot"></a></dt>
<dd><p>Numeric scalar, the largest number of
significant complexes to generate separate volcano plots for.</p></dd>


<dt id="arg-curveparam">curveparam<a class="anchor" aria-label="anchor" href="#arg-curveparam"></a></dt>
<dd><p>List with curve parameters for creating the Perseus-like
significance curves in the volcano plots.</p></dd>


<dt id="arg-abundancecolpat">abundanceColPat<a class="anchor" aria-label="anchor" href="#arg-abundancecolpat"></a></dt>
<dd><p>Character vector providing the column patterns used
to identify abundance columns in the result table, to make bar plots
for significant complexes. Typically the name of an assay.</p></dd>


<dt id="arg-xlab-ylab-xlabma">xlab, ylab, xlabma<a class="anchor" aria-label="anchor" href="#arg-xlab-ylab-xlabma"></a></dt>
<dd><p>Character scalars giving the x- and y-axis labels to
use for the volcano plots, and the x-axis label to use for the MA plot.</p></dd>


<dt id="arg-labelonlysignificant">labelOnlySignificant<a class="anchor" aria-label="anchor" href="#arg-labelonlysignificant"></a></dt>
<dd><p>Logical scalar, whether to label only
significant features (where <code>volcind</code> is <code>TRUE</code>), or to
select the top <code>volcanoMaxFeatures</code> regardless of significance
status.</p></dd>


<dt id="arg-interactivedisplaycolumns">interactiveDisplayColumns<a class="anchor" aria-label="anchor" href="#arg-interactivedisplaycolumns"></a></dt>
<dd><p>Character vector (or <code>NULL</code>)
indicating which columns of <code>res</code> to include in the tooltip for the
interactive volcano plots. The default shows the feature ID.</p></dd>


<dt id="arg-interactivegroupcolumn">interactiveGroupColumn<a class="anchor" aria-label="anchor" href="#arg-interactivegroupcolumn"></a></dt>
<dd><p>Character scalar (or <code>NULL</code>, default)
indicating the column to group points by in the interactive volcano
plot. Hovering over a point will highlight all other points with the
same value of this column.</p></dd>


<dt id="arg-makeinteractivevolcano">makeInteractiveVolcano<a class="anchor" aria-label="anchor" href="#arg-makeinteractivevolcano"></a></dt>
<dd><p>Logical scalar, indicating whether to
construct an interactive volcano plot in addition to the static one.</p></dd>


<dt id="arg-maxtextwidthbarplot">maxTextWidthBarplot<a class="anchor" aria-label="anchor" href="#arg-maxtextwidthbarplot"></a></dt>
<dd><p>Numeric scalar giving the maximum allowed width
for text labels in the bar plot of log-fold changes. If not <code>NULL</code>,
the size of the labels will be scaled down in an attempt to keep the
labels inside the canvas. Typically set to half the width of the
plot device (in inches).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list with plot objects.
    If <code>baseFileName</code> is not <code>NULL</code>, pdf files with volcano
    plots and bar plots for significant complexes will also be generated.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Charlotte Soneson</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"mq_example"</span>, <span class="st">"1356_sce.rds"</span>,</span></span>
<span class="r-in"><span>                           package <span class="op">=</span> <span class="st">"einprot"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tres</span> <span class="op">&lt;-</span> <span class="fu"><a href="runTest.html">runTest</a></span><span class="op">(</span><span class="va">sce</span>, comparisons <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RBC_ctrl"</span>, <span class="st">"Adnp"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                testType <span class="op">=</span> <span class="st">"limma"</span>, assayForTests <span class="op">=</span> <span class="st">"log2_LFQ.intensity"</span>,</span></span>
<span class="r-in"><span>                assayImputation <span class="op">=</span> <span class="st">"imputed_LFQ.intensity"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pv</span> <span class="op">&lt;-</span> <span class="fu">plotVolcano</span><span class="op">(</span><span class="va">sce</span>, <span class="va">tres</span><span class="op">$</span><span class="va">tests</span><span class="op">$</span><span class="va">Adnp_vs_RBC_ctrl</span>, testType <span class="op">=</span> <span class="st">"limma"</span>,</span></span>
<span class="r-in"><span>                  comparisonString <span class="op">=</span> <span class="st">"Adnp_vs_RBC_ctrl"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 39 rows containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_interactive_point()`).</span>
<span class="r-in"><span><span class="va">pv</span><span class="op">$</span><span class="va">gg</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 39 rows containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_point()`).</span>
<span class="r-plt img"><img src="plotVolcano-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">pv</span><span class="op">$</span><span class="va">ggma</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 39 rows containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_point()`).</span>
<span class="r-plt img"><img src="plotVolcano-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">pv</span><span class="op">$</span><span class="va">ggwf</span></span></span>
<span class="r-plt img"><img src="plotVolcano-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Charlotte Soneson, Jan Seebacher, Michael Stadler.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

