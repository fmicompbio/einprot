<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Perform PTM test — runPTMTest • einprot</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Perform PTM test — runPTMTest"><meta property="og:description" content="Perform a test for post-translational modifications. If testType is
&quot;welch&quot;, the functions applies a Welch t-test to the log-fold changes
obtained from independent tests on the peptide and protein levels.
This effectively 'adjusts' the changes on the peptide level for the changes
seen in the corresponding protein. This approach is similar to the method
implemented in the MSstatsPTM package (Kohler et al 2022).
If testType is &quot;interaction&quot;, data from the peptide and protein
level are concatenated, and a model is fit to test for the significance
of the interaction between the &quot;value type&quot; and the condition, i.e.,
whether the difference between the groups depend on whether we are
considering the peptide or the protein-level abundances."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">einprot</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.7.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/einprot.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perform PTM test</h1>
    
    <div class="hidden name"><code>runPTMTest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Perform a test for post-translational modifications. If <code>testType</code> is
"welch", the functions applies a Welch t-test to the log-fold changes
obtained from independent tests on the peptide and protein levels.
This effectively 'adjusts' the changes on the peptide level for the changes
seen in the corresponding protein. This approach is similar to the method
implemented in the <code>MSstatsPTM</code> package (Kohler et al 2022).
If <code>testType</code> is "interaction", data from the peptide and protein
level are concatenated, and a model is fit to test for the significance
of the interaction between the "value type" and the condition, i.e.,
whether the difference between the groups depend on whether we are
considering the peptide or the protein-level abundances.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">runPTMTest</span><span class="op">(</span></span>
<span>  <span class="va">sceProteins</span>,</span>
<span>  <span class="va">scePeptides</span>,</span>
<span>  <span class="va">matchColProteins</span>,</span>
<span>  <span class="va">matchColPeptides</span>,</span>
<span>  <span class="va">testType</span>,</span>
<span>  <span class="va">comparisons</span>,</span>
<span>  groupComposition <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">assayForTests</span>,</span>
<span>  assayImputation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  minNbrValidValues <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  minlFC <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  volcanoAdjPvalThr <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  volcanoLog2FCThr <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  baseFileName <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  singleFit <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  subtractBaseline <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  baselineGroup <span class="op">=</span> <span class="st">""</span>,</span>
<span>  extraColumnsPeptides <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>sceProteins</dt>
<dd><p>A <code>SummarizedExperiment</code> object (or a derivative)
with protein-level abundances.</p></dd>


<dt>scePeptides</dt>
<dd><p>A <code>SummarizedExperiment</code> object (or a derivative)
with peptide-level abundances.</p></dd>


<dt>matchColProteins, matchColPeptides</dt>
<dd><p>Character scalars indicating
columns of <code>rowData(sceProteins)</code> and <code>rowData(scePeptides)</code>,
respectively, that will be used to extract matching record pairs.
Typically, this will be a column with the protein identifier.</p></dd>


<dt>testType</dt>
<dd><p>Either "welch" or "interaction", the type of test to
perform. See Details for a description.</p></dd>


<dt>comparisons</dt>
<dd><p>A list of character vectors of length 2, each giving the
two groups to be compared.</p></dd>


<dt>groupComposition</dt>
<dd><p>A list providing the composition of each group
used in any of the comparisons. If <code>NULL</code>, assumes that each
group used in <code>comparisons</code> consists of a single group in the
<code>group</code> column of <code>colData(sceProteins)</code> and
<code>colData(scePeptides)</code>.</p></dd>


<dt>assayForTests</dt>
<dd><p>Character scalar, the name of an assay of the
<code>SummarizedExperiment</code> object with values that will be used to
perform the test.</p></dd>


<dt>assayImputation</dt>
<dd><p>Character scalar, the name of an assay of
<code>sce</code> with logical values indicating whether an entry was imputed
or not.</p></dd>


<dt>minNbrValidValues</dt>
<dd><p>Numeric scalar, the minimum number of valid
(non-imputed) values that must be present for a features to include it
in the result table.</p></dd>


<dt>minlFC</dt>
<dd><p>Non-negative numeric scalar, the logFC threshold to use for
limma-treat. If <code>minlFC</code> = 0, <code><a href="https://rdrr.io/pkg/limma/man/ebayes.html" class="external-link">limma::eBayes</a></code> is used instead.</p></dd>


<dt>volcanoAdjPvalThr</dt>
<dd><p>Numeric scalar giving the FDR threshold for
significance (for later use in volcano plots).</p></dd>


<dt>volcanoLog2FCThr</dt>
<dd><p>Numeric scalar giving the logFC threshold for
significance (for later use in volcano plots).</p></dd>


<dt>baseFileName</dt>
<dd><p>Character scalar or <code>NULL</code>, the base file name of
the output text files. If <code>NULL</code>, no result files are generated.</p></dd>


<dt>singleFit</dt>
<dd><p>Logical scalar, whether to fit a single model to the full
data set and extract relevant results using contrasts. If <code>FALSE</code>,
the data set will be subset for each comparison to only the relevant
samples.</p></dd>


<dt>subtractBaseline</dt>
<dd><p>Logical scalar, whether to subtract the background/
reference value for each feature in each batch before fitting the
model. If <code>TRUE</code>, requires that a 'batch' column is available.</p></dd>


<dt>baselineGroup</dt>
<dd><p>Character scalar representing the reference group.
Only used if <code>subtractBaseline</code> is <code>TRUE</code>, in which case the
abundance values for a given sample will be adjusted by subtracting the
average value across all samples in the <code>baselineGroup</code> from the
same batch as the original sample.</p></dd>


<dt>extraColumnsPeptides</dt>
<dd><p>Character vector (or <code>NULL</code>) indicating
columns of <code>rowData(scePeptides)</code> to include in the result table.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list with the following components:</p><ul><li><p><code>tests</code> - a list with test results</p></li>
<li><p><code>plotnotes</code> - the prior df used by limma</p></li>
<li><p><code>plottitles</code> - indicating the type of test</p></li>
<li><p><code>plotsubtitles</code> - indicating the significance thresholds</p></li>
<li><p><code>messages</code> - any messages for the user</p></li>
<li><p><code>design</code> - information about the experimental design</p></li>
</ul><p>In addition, if <code>baseFileName</code> is not <code>NULL</code>, text files with
test results (including only features passing the imposed significance
thresholds) are saved.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Kohler D, Tsai T-H, Vershueren E, Huang T, Hinkle T, Phu L, Choi M,
Vitek O: MSstatsPTM: Statistical relative quantification of
post-translational modifiations in bottom-up mass spectrometry-based
proteomics. Molecular and Cellular Proteomics (2022).</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Charlotte Soneson</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Charlotte Soneson, Jan Seebacher, Michael Stadler.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

