% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/runPTMTest.R
\name{runPTMTest}
\alias{runPTMTest}
\title{Perform PTM test}
\usage{
runPTMTest(
  sceProteins,
  scePeptides,
  matchColProteins,
  matchColPeptides,
  testType,
  comparisons,
  groupComposition = NULL,
  assayForTests,
  assayImputation = NULL,
  minNbrValidValues = 0,
  minlFC = 0,
  volcanoAdjPvalThr = 0.05,
  volcanoLog2FCThr = 1,
  baseFileName = NULL,
  singleFit = FALSE,
  subtractBaseline = FALSE,
  baselineGroup = "",
  extraColumnsPeptides = NULL
)
}
\arguments{
\item{sceProteins}{A \code{SummarizedExperiment} object (or a derivative)
with protein-level abundances.}

\item{scePeptides}{A \code{SummarizedExperiment} object (or a derivative)
with peptide-level abundances.}

\item{matchColProteins, matchColPeptides}{Character scalars indicating
columns of \code{rowData(sceProteins)} and \code{rowData(scePeptides)},
respectively, that will be used to extract matching record pairs.
Typically, this will be a column with the protein identifier.}

\item{testType}{Either "welch" or "interaction", the type of test to
perform. See Details for a description.}

\item{comparisons}{A list of character vectors of length 2, each giving the
two groups to be compared.}

\item{groupComposition}{A list providing the composition of each group
used in any of the comparisons. If \code{NULL}, assumes that each
group used in \code{comparisons} consists of a single group in the
\code{group} column of \code{colData(sceProteins)} and
\code{colData(scePeptides)}.}

\item{assayForTests}{Character scalar, the name of an assay of the
\code{SummarizedExperiment} object with values that will be used to
perform the test.}

\item{assayImputation}{Character scalar, the name of an assay of
\code{sce} with logical values indicating whether an entry was imputed
or not.}

\item{minNbrValidValues}{Numeric scalar, the minimum number of valid
(non-imputed) values that must be present for a features to include it
in the result table.}

\item{minlFC}{Non-negative numeric scalar, the logFC threshold to use for
limma-treat. If \code{minlFC} = 0, \code{limma::eBayes} is used instead.}

\item{volcanoAdjPvalThr}{Numeric scalar giving the FDR threshold for
significance (for later use in volcano plots).}

\item{volcanoLog2FCThr}{Numeric scalar giving the logFC threshold for
significance (for later use in volcano plots).}

\item{baseFileName}{Character scalar or \code{NULL}, the base file name of
the output text files. If \code{NULL}, no result files are generated.}

\item{singleFit}{Logical scalar, whether to fit a single model to the full
data set and extract relevant results using contrasts. If \code{FALSE},
the data set will be subset for each comparison to only the relevant
samples.}

\item{subtractBaseline}{Logical scalar, whether to subtract the background/
reference value for each feature in each batch before fitting the
model. If \code{TRUE}, requires that a 'batch' column is available.}

\item{baselineGroup}{Character scalar representing the reference group.
Only used if \code{subtractBaseline} is \code{TRUE}, in which case the
abundance values for a given sample will be adjusted by subtracting the
average value across all samples in the \code{baselineGroup} from the
same batch as the original sample.}

\item{extraColumnsPeptides}{Character vector (or \code{NULL}) indicating
columns of \code{rowData(scePeptides)} to include in the result table.}
}
\value{
A list with the following components:
\itemize{
 \item{tests}{a list with test results}
 \item{plotnotes}{the prior df used by limma}
 \item{plottitles}{indicating the type of test}
 \item{plotsubtitles}{indicating the significance thresholds}
 \item{messages}{any messages for the user}
 \item{design}{information about the experimental design}
}
In addition, if \code{baseFileName} is not \code{NULL}, text files with
test results (including only features passing the imposed significance
thresholds) are saved.
}
\description{
Perform a test for post-translational modifications. If \code{testType} is
"welch", the functions applies a Welch t-test to the log-fold changes
obtained from independent tests on the peptide and protein levels.
This effectively 'adjusts' the changes on the peptide level for the changes
seen in the corresponding protein. This approach is similar to the method
implemented in the \code{MSstatsPTM} package (Kohler et al 2022).
If \code{testType} is "interaction", data from the peptide and protein
level are concatenated, and a model is fit to test for the significance
of the interaction between the "value type" and the condition, i.e.,
whether the difference between the groups depend on whether we are
considering the peptide or the protein-level abundances.
}
\references{
Kohler D, Tsai T-H, Vershueren E, Huang T, Hinkle T, Phu L, Choi M,
Vitek O: MSstatsPTM: Statistical relative quantification of
post-translational modifiations in bottom-up mass spectrometry-based
proteomics. Molecular and Cellular Proteomics (2022).
}
\author{
Charlotte Soneson
}
