% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/doFilter.R
\name{filterPDTMT}
\alias{filterPDTMT}
\title{Filter out features in PD/TMT data}
\usage{
filterPDTMT(
  sce,
  inputLevel,
  minScore = 0,
  minPeptides = 0,
  minDeltaScore = 0,
  minPSMs = 0,
  masterProteinsOnly = FALSE,
  modificationsCol = "Modifications",
  excludeUnmodifiedPeptides = FALSE,
  keepModifications = NULL,
  plotUpset = TRUE,
  exclFile = NULL
)
}
\arguments{
\item{sce}{A \code{SummarizedExperiment} object (or a derivative).}

\item{inputLevel}{Either \code{"Proteins"} or \code{"PeptideGroups"},
indicating the type of features in \code{sce}.}

\item{minScore}{Numeric scalar, the minimum allowed value in the
'Score.Sequest.HT.Sequest.HT' column in order to retain the feature.
Only used if \code{inputLevel} is \code{"Proteins"}.}

\item{minPeptides}{Numeric scalar, the minimum allowed value in the
'Number.of.Peptides' column in order to retain the feature.
Only used if \code{inputLevel} is \code{"Proteins"}.}

\item{minDeltaScore}{Numeric scalar, the minimum allowed value in the
'Delta.Score.by.Search.Engine.Sequest.HT' column in order to retain the
feature. Only used if \code{inputLevel} is \code{"PeptideGroups"}.}

\item{minPSMs}{Numeric scalar, the minimum allowed value in the
'Number.of.PSMs' column in order to retain the feature.
Only used if \code{inputLevel} is \code{"PeptideGroups"}.}

\item{masterProteinsOnly}{Logical scalar indicating whether only master
proteins (where the \code{Master} column value is
\code{IsMasterProtein}) should be retained.}

\item{modificationsCol}{Character string pointing to a column containing
modification details. \code{excludeUnmodifiedPeptides} and
\code{keepModifications} will use information from this column. Only
used if \code{inputLevel} is \code{"PeptideGroups"}.}

\item{excludeUnmodifiedPeptides}{Logical scalar, whether to filter out
peptides without modifications. Only used if \code{inputLevel} is
\code{"PeptideGroups"}.}

\item{keepModifications}{Character string (or \code{NULL}) indicating
which modifications to retain in the analysis. Can be a regular
expression, which will be matched against the \code{modificationsCol}.
If \code{NULL} (the default), all rows are retained. Only used if
\code{inputLevel} is \code{"PeptideGroups"}.}

\item{plotUpset}{Logical scalar, whether to generate an UpSet plot
detailing the reasons for features being filtered out. Only
generated if any feature is in fact filtered out.}

\item{exclFile}{Character scalar, the path to a text file where the
features that are filtered out are written. If \code{NULL} (default),
excluded features are not recorded.}
}
\value{
A filtered object of the same type as \code{sce}.
}
\description{
If \code{inputLevel} is "Proteins", exclude features with
'Score.Sequest.HT.Sequest.HT' below \code{minScore},
'Number.of.Peptides' below \code{minPeptides}, or identified as
'Contaminant' by \code{ProteomeDiscoverer}.
If \code{inputLevel} is "PeptideGroups", exclude features with
'Delta.Score.by.Search.Engine.Sequest.HT' below \code{minDeltaScore},
'Number.of.PSMs' below \code{minPSMs}, or identified as
'Contaminant' by \code{ProteomeDiscoverer}.
}
\examples{
## Proteins
sce <- importExperiment(
    inFile = system.file("extdata", "pdtmt_example",
                         "Fig2_m23139_RTS_QC_varMods_Proteins.txt",
                         package = "einprot"),
    iColPattern = "^Abundance.F.+.Sample.")$sce

dim(sce)
sce <- filterPDTMT(sce = sce, inputLevel = "Proteins", minScore = 2,
                   minPeptides = 2, plotUpset = TRUE)
dim(sce)

## PeptideGroups
sce <- importExperiment(
    inFile = system.file("extdata", "pdtmt_example",
                         "Fig2_m23139_RTS_QC_varMods_PeptideGroups.txt",
                         package = "einprot"),
    iColPattern = "^Abundance.F.+.Sample.")$sce

dim(sce)
sce <- filterPDTMT(sce = sce, inputLevel = "PeptideGroups",
                   minPSMs = 2, plotUpset = TRUE, minDeltaScore = 0.2,
                   modificationsCol = "Modifications.in.Master.Proteins",
                   excludeUnmodifiedPeptides = TRUE)
dim(sce)

}
\author{
Charlotte Soneson
}
