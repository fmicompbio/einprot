% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/subtractBaseline.R
\name{getMatSubtractedBaseline}
\alias{getMatSubtractedBaseline}
\title{Extract a matrix and subtract the background/baseline for each feature}
\usage{
getMatSubtractedBaseline(sce, assayName, baselineGroup, sceFull)
}
\arguments{
\item{sce}{A \code{SummarizedExperiment} object. The \code{colData} of the
object must have at least columns named 'group' and 'batch'.}

\item{assayName}{The name of the assay to extract from \code{sce}.}

\item{baselineGroup}{The value of the 'group' column of
\code{colData(sceFull)} that corresponds to the baseline/reference
samples.}

\item{sceFull}{A \code{SummarizedExperiment} object containing at least
the reference samples for each batch in \code{sce}.}
}
\value{
Matrix with baseline-subtracted abundances.
}
\description{
Extract an assay from a \code{SummarizedExperiment}, and for each feature
subtract the average value across a set of reference/background/baseline
samples, and add the average across all the baseline samples to retain
information about overall abundance. Typically used to adjust for varying
baselines between batches, when a reference sample is included in each batch.
}
\examples{
sce <- readRDS(system.file("extdata", "mq_example", "1356_sce.rds",
                           package = "einprot"))

## Introduce artificial batch column
sce$batch <- rep(c("B1", "B2", "B3"), 3)
SummarizedExperiment::colData(sce)
mat <- getMatSubtractedBaseline(sce, assayName = "log2_LFQ.intensity",
                                baselineGroup = "RBC_ctrl",
                                sceFull = sce)
## After the subtraction, the baseline samples are equalized across the
## different batches
head(mat)

}
\author{
Charlotte Soneson
}
