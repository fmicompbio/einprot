% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/runTests.R
\name{runTest}
\alias{runTest}
\title{Run statistical test}
\usage{
runTest(
  sce,
  comparisons,
  groupComposition = NULL,
  testType,
  assayForTests,
  assayImputation = NULL,
  minNbrValidValues = 2,
  minlFC = 0,
  featureCollections = list(),
  complexFDRThr = 0.1,
  volcanoAdjPvalThr = 0.05,
  volcanoLog2FCThr = 1,
  baseFileName = NULL,
  seed = 123,
  samSignificance = TRUE,
  nperm = 250,
  volcanoS0 = 0.1,
  addAbundanceValues = FALSE,
  aName = NULL,
  singleFit = TRUE,
  subtractBaseline = FALSE,
  baselineGroup = ""
)
}
\arguments{
\item{sce}{A \code{SummarizedExperiment} object (or a derivative).}

\item{comparisons}{A list of character vectors of length 2, each giving the
two groups to be compared.}

\item{groupComposition}{A list providing the composition of each group
used in any of the comparisons. If \code{NULL}, assumes that each
group used in \code{comparisons} consists of a single group in the
\code{group} column of \code{colData(sce)}.}

\item{testType}{Character scalar, either "limma", "ttest" or "proDA".}

\item{assayForTests}{Character scalar, the name of an assay of the
\code{SummarizedExperiment} object with values that will be used to
perform the test.}

\item{assayImputation}{Character scalar, the name of an assay of
\code{sce} with logical values indicating whether an entry was imputed
or not.}

\item{minNbrValidValues}{Numeric scalar, the minimum number of valid
(non-imputed) values that must be present for a features to include it
in the result table.}

\item{minlFC}{Non-negative numeric scalar, the logFC threshold to use for
limma-treat. If \code{minlFC} = 0, \code{limma::eBayes} is used instead.}

\item{featureCollections}{List of CharacterLists with feature collections.}

\item{complexFDRThr}{Numeric scalar giving the significance (FDR) threshold
below which a complex will be considered significant.}

\item{volcanoAdjPvalThr}{Numeric scalar giving the FDR threshold for
significance (for later use in volcano plots).}

\item{volcanoLog2FCThr}{Numeric scalar giving the logFC threshold for
significance (for later use in volcano plots).}

\item{baseFileName}{Character scalar or \code{NULL}, the base file name of
the output text files. If \code{NULL}, no result files are generated.}

\item{seed}{Numeric scalar, the random seed to use for permutation (only
used if \code{testType} is \code{"ttest"}).}

\item{samSignificance}{Logical scalar, indicating whether the SAM statistic
should be used to determine significance (similar to the approach used by
Perseus). Only used if \code{testType = "ttest"}. If \code{FALSE}, the
p-values are adjusted using the Benjamini-Hochberg approach and used
to determine significance.}

\item{nperm}{Numeric scalar, the number of permutations (only
used if \code{testType} is \code{"ttest"}).}

\item{volcanoS0}{Numeric scalar, the S0 value to use for creating
significance curves (only used if \code{testType} is \code{"ttest"}).}

\item{addAbundanceValues}{Logical scalar, whether to extract abundance
and add to the result table.}

\item{aName}{Character scalar, the name of the assay in the
\code{SummarizedExperiment} object to get abundance values from (only
required if \code{addAbundanceValues} is \code{TRUE}).}

\item{singleFit}{Logical scalar, whether to fit a single model to the full
data set and extract relevant results using contrasts. If \code{FALSE},
the data set will be subset for each comparison to only the relevant
samples. Setting \code{singleFit} to \code{TRUE} is only supported
for \code{testType = "limma"} or \code{"proDA"}.}

\item{subtractBaseline}{Logical scalar, whether to subtract the background/
reference value for each feature in each batch before fitting the
model. If \code{TRUE}, requires that a 'batch' column is available.}

\item{baselineGroup}{Character scalar representing the reference group.
Only used if \code{subtractBaseline} is \code{TRUE}, in which case the
abundance values for a given sample will be adjusted by subtracting the
average value across all samples in the \code{baselineGroup} from the
same batch as the original sample.}
}
\value{
A list with seven components: \code{tests} (a list with test
results), \code{plotnotes} (the prior df used by limma), \code{plottitles}
(indicating the type of test), \code{plotsubtitles} (indicating the
significance thresholds), \code{featureCollections} (list of
feature sets, expanded with results from camera), \code{topsets}
(a list with the significant feature sets), \code{messages} (any
messages for the user), \code{design} (information about the
experimental design) and \code{curveparams} (information required to
create Perseus-like significance curves). In addition, if
\code{baseFileName} is not \code{NULL}, text files with test results
(including only features and feature sets passing the imposed significance
thresholds) are saved.
}
\description{
Run statistical test
}
\author{
Charlotte Soneson
}
