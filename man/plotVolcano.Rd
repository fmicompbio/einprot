% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plotVolcano.R
\name{plotVolcano}
\alias{plotVolcano}
\title{Make volcano plots}
\usage{
plotVolcano(
  sce,
  res,
  testType,
  xv = NULL,
  yv = NULL,
  xvma = NULL,
  volcind = NULL,
  plotnote = "",
  plottitle = "",
  plotsubtitle = "",
  volcanoFeaturesToLabel = c(""),
  volcanoMaxFeatures = 25,
  volcanoLabelSign = "both",
  baseFileName = NULL,
  comparisonString,
  groupComposition = NULL,
  stringDb = NULL,
  featureCollections = list(),
  complexFDRThr = 0.1,
  maxNbrComplexesToPlot = 10,
  curveparam = list(),
  abundanceColPat = "",
  xlab = "log2(fold change)",
  ylab = "-log10(p-value)",
  xlabma = "Average abundance",
  labelOnlySignificant = TRUE,
  interactiveDisplayColumns = NULL,
  interactiveGroupColumn = NULL,
  makeInteractiveVolcano = TRUE,
  maxTextWidthBarplot = NULL
)
}
\arguments{
\item{sce}{A \code{SummarizedExperiment} object (or a derivative). Can be
\code{NULL} if no "complex bar plots" are made (i.e., if
\code{featureCollections} has no entry named "complexes", or if
\code{baseFileName} is \code{NULL}).}

\item{res}{A \code{data.frame} object with test results (typically
generated by \code{runTest}).}

\item{testType}{Character scalar indicating the type of test that was run,
either \code{"ttest"}, \code{"limma"} or \code{"proDA"}.}

\item{xv, yv}{Character scalars indicating which columns of \code{res} that
should be used as the x- and y-axis of the volcano plot, respectively.
If \code{NULL}, will be determined based on \code{testType}.}

\item{xvma}{If not \code{NULL}, a character scalar indicating which
column of \code{res} should be used as the x-axis for an MA plot. The
y-axis column will be \code{xv}. If \code{NULL}, no MA plot is
generated.}

\item{volcind}{Character scalar indicating which column in \code{res} that
represents the "significance" column. This should be a logical
column; rows with a value equal to \code{TRUE} will be colored
in the plot. If \code{NULL}, will be determined based on \code{testType}.}

\item{plotnote}{Character scalar with a note to add to the plot.}

\item{plottitle}{Character scalar giving the title of the plot.}

\item{plotsubtitle}{Character scalar giving the subtitle of the plot.}

\item{volcanoFeaturesToLabel}{Character vector, features to label in the
plot.}

\item{volcanoMaxFeatures}{Numeric scalar, the maximum number of features
to color in the plot.}

\item{volcanoLabelSign}{Character scalar, either \code{"both"}, \code{"pos"},
or \code{"neg"}, indicating whether to label the most significant
features regardless of sign, or only those with positive/negative
log-fold changes.}

\item{baseFileName}{Character scalar or \code{NULL}, the base file name of
the output files. If \code{NULL}, no result files are generated.}

\item{comparisonString}{Character scalar giving the name of the comparison of
interest. This is used to extract the appropriate column from the
metadata of the feature collections to make the gene set plots.}

\item{groupComposition}{A list providing the composition of each group
used in the comparisons indicated by \code{comparisonString}.
If \code{NULL}, assumes that each group used in \code{comparisonString}
consists of a single group in the \code{group} column of
\code{colData(sce)}.}

\item{stringDb}{A STRINGdb object or \code{NULL}. If not \code{NULL},
STRING network plots of up- and downregulated genes will be added to
the output pdf file.}

\item{featureCollections}{A list of \code{CharacterList}s with feature
collections. If there is a collection named \code{"complexes"},
volcano plots and barplots for significant complexes are included in
the output pdf files.}

\item{complexFDRThr}{Numeric scalar giving the FDR threshold for complexes
to be considered significant.}

\item{maxNbrComplexesToPlot}{Numeric scalar, the largest number of
significant complexes to generate separate volcano plots for.}

\item{curveparam}{List with curve parameters for creating the Perseus-like
significance curves in the volcano plots.}

\item{abundanceColPat}{Character vector providing the column patterns used
to identify abundance columns in the result table, to make bar plots
for significant complexes. Typically the name of an assay.}

\item{xlab, ylab, xlabma}{Character scalars giving the x- and y-axis labels to
use for the volcano plots, and the x-axis label to use for the MA plot.}

\item{labelOnlySignificant}{Logical scalar, whether to label only
significant features (where \code{volcind} is \code{TRUE}), or to
select the top \code{volcanoMaxFeatures} regardless of significance
status.}

\item{interactiveDisplayColumns}{Character vector (or \code{NULL})
indicating which columns of \code{res} to include in the tooltip for the
interactive volcano plots. The default shows the feature ID.}

\item{interactiveGroupColumn}{Character scalar (or \code{NULL}, default)
indicating the column to group points by in the interactive volcano
plot. Hovering over a point will highlight all other points with the
same value of this column.}

\item{makeInteractiveVolcano}{Logical scalar, indicating whether to
construct an interactive volcano plot in addition to the static one.}

\item{maxTextWidthBarplot}{Numeric scalar giving the maximum allowed width
for text labels in the bar plot of log-fold changes. If not \code{NULL},
the size of the labels will be scaled down in an attempt to keep the
labels inside the canvas. Typically set to half the width of the
plot device (in inches).}
}
\value{
A list with plot objects.
    If \code{baseFileName} is not \code{NULL}, pdf files with volcano
    plots and bar plots for significant complexes will also be generated.
}
\description{
Construct interactive and non-interactive volcano plots, MA plots,
STRING networks of up- and downregulated proteins, bar plots of average
abundances and log-fold changes, as well as plots of top-ranked feature
collections.
}
\examples{
sce <- readRDS(system.file("extdata", "mq_example", "1356_sce.rds",
                           package = "einprot"))
tres <- runTest(sce, comparisons = list(c("RBC_ctrl", "Adnp")),
                testType = "limma", assayForTests = "log2_LFQ.intensity",
                assayImputation = "imputed_LFQ.intensity")
pv <- plotVolcano(sce, tres$tests$Adnp_vs_RBC_ctrl, testType = "limma",
                  comparisonString = "Adnp_vs_RBC_ctrl")
pv$gg
pv$ggma
pv$ggwf

}
\author{
Charlotte Soneson
}
