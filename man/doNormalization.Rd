% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/doNormalization.R
\name{doNormalization}
\alias{doNormalization}
\title{Apply normalization}
\usage{
doNormalization(
  sce,
  method,
  assayName,
  normalizedAssayName,
  spikeFeatures = NULL
)
}
\arguments{
\item{sce}{A \code{SummarizedExperiment} object (or a derivative).}

\item{method}{Character scalar giving the normalization method. Currently,
the methods from \code{MsCoreUtils::normalizeMethods()} are supported.
If \code{spikeFeatures} is not \code{NULL}, only
\code{"center.mean"}, \code{"center.median"}, \code{"div.mean"} and
\code{"div.median"} are supported.}

\item{assayName}{Character scalar giving the name of the assay in \code{sce}
to be normalized.}

\item{normalizedAssayName}{Character scalar providing the name that will be
given to the assay containing normalized values.}

\item{spikeFeatures}{Character vector of feature IDs (rownames of sce)
that will be used to calculate normalization factors. If \code{NULL}
(default), all features are used.}
}
\value{
An object of the same type as \code{sce} with an additional assay
    named \code{normalizedAssayName}.
}
\description{
Apply normalization to an assay in a \code{SummarizedExperiment} object and
add a new assay containing the normalized values.
}
\examples{
## Import data
sce <- importExperiment(system.file("extdata", "mq_example",
                                    "1356_proteinGroups.txt",
                                    package = "einprot"),
                        iColPattern = "^iBAQ\\\\.")$sce

## Log-transform iBAQ values
SummarizedExperiment::assay(sce, "log2_iBAQ") <-
    log2(SummarizedExperiment::assay(sce, "iBAQ"))

## Replace non-finite values by NA
SummarizedExperiment::assay(sce, "log2_iBAQ")[!is.finite(
    SummarizedExperiment::assay(sce, "log2_iBAQ"))] <- NA

## Normalize between samples using median centering
sce <- doNormalization(sce, method = "center.median", assayName = "log2_iBAQ",
                       normalizedAssayName = "normalized_iBAQ")
SummarizedExperiment::assayNames(sce)

## Check that the median is zero for all samples in the normalized data
apply(SummarizedExperiment::assay(sce, "normalized_iBAQ"), 2, median,
      na.rm = TRUE)

}
\author{
Charlotte Soneson
}
