% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/doPCA.R
\name{doPCA}
\alias{doPCA}
\title{Run PCA and generate plots}
\usage{
doPCA(
  sce,
  assayName,
  ncomponents = 10,
  ntop = Inf,
  plotpairs = list(c(1, 2)),
  maxNGroups = 10,
  maxTextWidthBarplot = NULL,
  colourBy = "group",
  subset_row = NULL,
  scale = FALSE
)
}
\arguments{
\item{sce}{A \code{SingleCellExperiment} object.}

\item{assayName}{Character scalar defining the assay in \code{sce} to
use for the PCA.}

\item{ncomponents}{Numeric scalar, the (maximal) number of components to
extract. The actual number can be lower if the number of samples is
too small.}

\item{ntop}{Number of features (with highest variance) to use to
generate the PCA. Will be passed on to \code{scater::runPCA}.}

\item{plotpairs}{A list of numeric vectors of length 2, indicating which
pairs of PCs to generate plots for.}

\item{maxNGroups}{Numeric scalar, the maximum number of groups to display
in the legend in the scatter plot in the combined plot. If there are
more than \code{maxNGroups} groups, the legend is suppressed.}

\item{maxTextWidthBarplot}{Numeric scalar giving the maximum allowed width
for text labels in the bar plot of log-fold changes. If not \code{NULL},
the size of the labels will be scaled down in an attempt to keep the
labels inside the canvas. Typically set to half the width of the
plot device (in inches).}

\item{colourBy}{Character scalar indicating the name of the column of
\code{colData(sce)} that will be used to colour the points.}

\item{subset_row}{Vector specifying the subset of features to use for
dimensionality reduction. Can be a character vector of row names, an
integer vector of row indices or a logical vector. Will be passed to
\code{scater::runPCA}.}

\item{scale}{Logical scalar indicating whether the values should be scaled
before the PCA is applied. Will be passed to \code{scater::runPCA}.}
}
\value{
A list with the following components:
\itemize{
 \item{\code{sce}}{ - the input sce, expanded with the calculated PCs, in
 addition the feature coefficients will be added to the \code{rowData}.}
 \item{\code{plotcoord}}{ - a list of \code{ggplot} objects containing
 coordinate plots for the desired pairs of components.}
 \item{\code{plotcombined}}{ - a list of \code{ggplot} objects containing
 combined coordinate, scree and coefficient plots for the desired pairs of
 components.}
 \item{\code{plotpairs}}{ - a \code{ggpairs} plot with all extracted
 components.}
}
}
\description{
Apply PCA to the assay defined by \code{assayName} and extract the top
\code{ncomponent} components. For each pair defined in \code{plotpairs},
generate a collection of plots.
}
\author{
Charlotte Soneson
}
